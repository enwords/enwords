<div class="container" style="padding-bottom: 20px">
  <% @sentences.each do |sentence| %>
      <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2" id="training-sentence">
        <h3>
          <% if sentence.audio.nil? %>
              <span class="audioButton glyphicon glyphicon-volume-off"></span>
          <% else %>
              <span class="audioButton glyphicon glyphicon-volume-up" onclick="play()"></span>
              <%= audio_tag("https://audio.tatoeba.org/sentences/#{sentence.language}/#{sentence.id}.mp3",
                            autoplay: false, id: 'audio-play') %>
          <% end %>
          <%= sentence.sentence %> </h3>
        <% begin %>
            <button id="translate-btn">Показать перевод</button>
            <h4 id="translate" style="display: none"><%= sentence.translations.where(language: current_user.native_language).first.sentence %> </h4>
        <% rescue %>
        <% end %>
      </div>


      <div class="col-xs-12 col-sm-6 col-sm-offset-3">
        <table>
          <th></th>
          <th style="text-align: center">Знаете?</th>
          <% n = 0
             sentence.words.each do |word|
               begin
                 current_bool = word.word_statuses.where(user_id: current_user.id).first.learned
              rescue

               end
               left_position = '3px'
               right_position = '30px'
               current_position = left_position
               colors = {
                   future_bool: true.to_s,
                   current_background: 'rgb(183, 183, 183)',
                   grey_background: 'rgb(183, 183, 183)',
                   orange_background: 'rgb(240, 173, 78)',
                   green_background: 'rgb(92, 184, 92)'}
               if current_bool.equal?(false)
                 colors[:future_bool]= true.to_s
                 colors[:current_background] = colors[:orange_background]
                 current_position = left_position
               elsif current_bool.equal?(true)
                 colors[:future_bool] = false.to_s
                 colors[:current_background]= colors[:green_background]
                 current_position = right_position
               end
          %>

              <tr class='<%= cycle('odd', 'even') %>'>
                <td style="width: 100%; "><%= word.word.capitalize %></td>
                <td>
                  <label class="switch">
                    <div class="slider" style="background-color: <%= colors[:current_background] %>"></div>
                    <div class="round" style="left: <%= current_position %>"></div>
                    <%= link_to '', {
                        controller: 'words', action: 'create_or_update_word_status', bool: colors[:future_bool],
                        word_id: word.id}, rel: "nofollow", method: :post, onclick: "setColor('#{ colors[:grey_background] }',
                      '#{colors[:orange_background]}', '#{colors[:green_background]}', #{n}, '#{left_position}', '#{right_position}')" , class: "button_hide" %>
                  </label>
                </td>
              </tr>
              <% n = n + 1 %>
          <% end %>
        </table>
      </div>
  <% end %>
</div>

<% if params[:page] == @total_pages.to_s %>
    <div class="digg_pagination" id="pagination-training-without_next_page">
      <%= will_paginate @sentences, page_links: false, previous_label: '❬', next_label: '❭', container: false %>
      <%= link_to 'Завершить', result_path, id: "end_link" %>
    </div>

<% else %>
    <div class="digg_pagination" id="pagination-training">
      <%= will_paginate @sentences, page_links: false, previous_label: '❬', next_label: '❭' , container: false%>
    </div>
<% end %>

<style>

</style>

<script>

  $(document).ready(function () {
    <% if current_user.audio_enable %>
    play();
    <% end %>
    $("#translate-btn").click(function () {
      $("#translate-btn").fadeOut(0);
      $("#translate").fadeIn(750);
    });
  });
</script>
